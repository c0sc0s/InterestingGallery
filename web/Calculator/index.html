<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ— ç”¨è®¡ç®—å™¨ | The Useless Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Serif+SC:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #121212;
            font-family: 'JetBrains Mono', monospace;
            touch-action: manipulation;
            transition: background-color 0.5s ease, filter 0.3s ease;
            overflow: hidden; /* é˜²æ­¢æ‰è½åŠ¨ç”»æ’‘å¤§é¡µé¢ */
        }

        /* åŸºç¡€ UI */
        .calc-btn {
            transition: all 0.1s active, transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            z-index: 10;
            position: relative;
        }
        .calc-btn:active {
            transform: scale(0.95);
        }

        .screen-glow {
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }

        .answer-font {
            font-family: 'Noto Serif SC', serif;
            line-height: 1.3;
        }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* --- æ··æ²Œç‰¹æ•ˆ (Chaos Effects) --- */

        /* 1. å‰§çƒˆéœ‡åŠ¨ */
        @keyframes violent-shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .shake-hard {
            animation: violent-shake 0.5s;
            animation-iteration-count: infinite;
        }

        /* 2. èµ›åšæ•…éšœ (Glitch) */
        .glitch-text {
            position: relative;
            animation: glitch-skew 1s infinite linear alternate-reverse;
        }
        .glitch-text::before, .glitch-text::after {
            content: attr(data-text);
            position: absolute;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
        }
        .glitch-text::before {
            left: 2px;
            text-shadow: -1px 0 #ff00c1;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim 5s infinite linear alternate-reverse;
        }
        .glitch-text::after {
            left: -2px;
            text-shadow: -1px 0 #00fff9;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim2 5s infinite linear alternate-reverse;
        }
        @keyframes glitch-anim {
            0% { clip: rect(31px, 9999px, 94px, 0); transform: skew(0.85deg); }
            20% { clip: rect(6px, 9999px, 3px, 0); transform: skew(0.05deg); }
            40% { clip: rect(28px, 9999px, 26px, 0); transform: skew(0.15deg); }
            60% { clip: rect(53px, 9999px, 42px, 0); transform: skew(0.55deg); }
            80% { clip: rect(15px, 9999px, 80px, 0); transform: skew(0.25deg); }
            100% { clip: rect(42px, 9999px, 18px, 0); transform: skew(0.65deg); }
        }
        @keyframes glitch-anim2 {
            0% { clip: rect(65px, 9999px, 100px, 0); transform: skew(0.25deg); }
            20% { clip: rect(32px, 9999px, 20px, 0); transform: skew(0.85deg); }
            40% { clip: rect(10px, 9999px, 65px, 0); transform: skew(0.05deg); }
            60% { clip: rect(80px, 9999px, 5px, 0); transform: skew(0.35deg); }
            80% { clip: rect(20px, 9999px, 35px, 0); transform: skew(0.95deg); }
            100% { clip: rect(5px, 9999px, 90px, 0); transform: skew(0.15deg); }
        }

        /* 3. çœ©æ™•æ—‹è½¬ */
        .dizzy {
            transition: transform 2s ease;
            transform: rotate(180deg) scale(0.8);
        }

        /* 4. é‡åŠ›å´©å (JSæ§åˆ¶ transform) */
        .fallen {
            pointer-events: none; /* æ‰è½åä¸å¯ç‚¹å‡» */
        }
        
        /* 5. æ¨¡ç³Š */
        .blurred {
            filter: blur(4px);
        }

        /* 6. è¿ªæ–¯ç§‘ */
        @keyframes disco-bg {
            0% { background-color: #121212; }
            25% { background-color: #4a0404; }
            50% { background-color: #042f4a; }
            75% { background-color: #044a15; }
            100% { background-color: #121212; }
        }
        .disco-mode {
            animation: disco-bg 2s infinite;
        }

        /* åŠ¨ç”»è¾…åŠ© */
        .fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body id="body" class="h-screen w-full flex items-center justify-center bg-neutral-900 selection:bg-orange-500 selection:text-white">

    <!-- è®¡ç®—å™¨å¤–å£³ -->
    <div id="calculator" class="w-full max-w-sm bg-black rounded-[2rem] p-5 shadow-2xl border border-neutral-800 relative transition-all duration-700 ease-in-out">
        
        <!-- è£…é¥°æ€§å…‰æ³½ -->
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-neutral-700 to-transparent opacity-50"></div>

        <!-- æ˜¾ç¤ºå±åŒºåŸŸ -->
        <div class="h-48 mb-4 flex flex-col justify-end items-end p-2 text-right relative z-20">
            <!-- å°å­—ï¼šè¿ç®—è¿‡ç¨‹ (ä¼ªè£…) -->
            <div id="history" class="text-neutral-500 text-lg mb-1 h-6 w-full truncate transition-opacity duration-300"></div>
            
            <!-- å¤§å­—ï¼šä¸»æ˜¾ç¤º/ç­”æ¡ˆ -->
            <div id="display" data-text="0" class="text-white text-5xl font-light break-words w-full screen-glow transition-all duration-300 max-h-32 overflow-y-auto no-scrollbar flex items-end justify-end">
                0
            </div>
        </div>

        <!-- é”®ç›˜åŒºåŸŸ -->
        <div id="keypad" class="grid grid-cols-4 gap-3 relative z-10">
            <!-- Row 1 -->
            <button onclick="clearDisplay()" class="calc-btn h-16 w-16 rounded-full bg-neutral-400 text-black text-2xl font-bold hover:bg-neutral-300 flex items-center justify-center">AC</button>
            <button onclick="appendSymbol('Â±')" class="calc-btn h-16 w-16 rounded-full bg-neutral-400 text-black text-2xl font-bold hover:bg-neutral-300 flex items-center justify-center">+/-</button>
            <button onclick="appendSymbol('%')" class="calc-btn h-16 w-16 rounded-full bg-neutral-400 text-black text-2xl font-bold hover:bg-neutral-300 flex items-center justify-center">%</button>
            <button onclick="appendOperator('Ã·')" class="calc-btn h-16 w-16 rounded-full bg-orange-500 text-white text-3xl font-bold hover:bg-orange-400 flex items-center justify-center pb-1">Ã·</button>

            <!-- Row 2 -->
            <button onclick="appendNumber('7')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">7</button>
            <button onclick="appendNumber('8')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">8</button>
            <button onclick="appendNumber('9')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">9</button>
            <button onclick="appendOperator('Ã—')" class="calc-btn h-16 w-16 rounded-full bg-orange-500 text-white text-3xl font-bold hover:bg-orange-400 flex items-center justify-center pb-1">Ã—</button>

            <!-- Row 3 -->
            <button onclick="appendNumber('4')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">4</button>
            <button onclick="appendNumber('5')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">5</button>
            <button onclick="appendNumber('6')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">6</button>
            <button onclick="appendOperator('-')" class="calc-btn h-16 w-16 rounded-full bg-orange-500 text-white text-3xl font-bold hover:bg-orange-400 flex items-center justify-center pb-1">-</button>

            <!-- Row 4 -->
            <button onclick="appendNumber('1')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">1</button>
            <button onclick="appendNumber('2')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">2</button>
            <button onclick="appendNumber('3')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">3</button>
            <button onclick="appendOperator('+')" class="calc-btn h-16 w-16 rounded-full bg-orange-500 text-white text-3xl font-bold hover:bg-orange-400 flex items-center justify-center pb-1">+</button>

            <!-- Row 5 -->
            <button onclick="appendNumber('0')" class="calc-btn h-16 w-[10.5rem] rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 pl-7 flex items-center justify-start col-span-2">0</button>
            <button onclick="appendNumber('.')" class="calc-btn h-16 w-16 rounded-full bg-neutral-800 text-white text-3xl hover:bg-neutral-700 flex items-center justify-center">.</button>
            <button onclick="calculateUselessly()" id="equal-btn" class="calc-btn h-16 w-16 rounded-full bg-orange-500 text-white text-3xl font-bold hover:bg-white hover:text-orange-500 transition-colors duration-300 flex items-center justify-center pb-1">=</button>
        </div>
        
        <!-- åº•éƒ¨æ ‡è¯­ -->
        <div class="text-center mt-6 text-neutral-700 text-xs tracking-widest uppercase opacity-40">
            Instrumental Rationality is Dead
        </div>
    </div>

    <script>
        const display = document.getElementById('display');
        const history = document.getElementById('history');
        const calculator = document.getElementById('calculator');
        const body = document.getElementById('body');
        const buttons = document.querySelectorAll('.calc-btn');

        let currentInput = '0';
        let previousInput = '';
        let operator = null;
        let isShowingAnswer = false;
        let activeEffects = [];

        // -------------------------------------------------------
        // 1. æ‰©å……è¯æ±‡åº“ (The Vocabulary of Chaos)
        // -------------------------------------------------------
        const vocab = {
            nouns: [
                "åœŸè±†", "å®‡å®™", "æ‚²ä¼¤", "æ˜ŸæœŸä¸‰", "æ•°å­¦", "æ²‰é»˜", "çŒ«", "é›¨æ»´", "çµé­‚", "ç®—æ³•", 
                "æ™šéœ", "è™šæ— ", "æ„ä¹‰", "404é”™è¯¯", "é•¿é¢ˆé¹¿", "å¾®é£", "å›å£°", "æ¢¦æƒ³", "æµ·æµª", "ç­”æ¡ˆ", 
                "å¡‘æ–™è¢‹", "æœˆäº®", "å“²å­¦", "é‡å­", "ç•ªèŒ„", "å­¤ç‹¬", "æ—¶é—´", "ç¢ç‰‡", "è°è¨€", "çœŸç†",
                "ä¾¿åˆ©åº—", "æ²™å‘", "äº‘æœµ", "å†°æ·‡æ·‹", "é‡åŠ›", "è¯—æ­Œ", "å›è½¦é”®", "é»‘èƒ¶å”±ç‰‡", "ä»™äººæŒ",
                "æ—§ç”µæ± ", "æé¾™åŒ–çŸ³", "æ°”æ³¡æ°´", "æ‰“å­—æœº", "éœ“è™¹ç¯", "ä¾¿åˆ©è´´", "æ·±æ¸Š", "é»‘æ´", "bug"
            ],
            adjectives: [
                "å¿§éƒçš„", "é€æ˜çš„", "æ„¤æ€’çš„", "å¯‚é™çš„", "æ°¸æ’çš„", "ç ´ç¢çš„", "ç”œèœœçš„", "è’è°¬çš„", 
                "è“è‰²çš„", "æ— ç”¨çš„", "ç–²æƒ«çš„", "å·¨å¤§çš„", "å¾®å°çš„", "å¤±é‡çš„", "è¿·èŒ«çš„", "æŸ”è½¯çš„", 
                "ç”Ÿé”ˆçš„", "é¥è¿œçš„", "è¢«é—å¿˜çš„", "å±é™©çš„", "æ¸©æŸ”çš„", "ä¸å¯è®¡ç®—çš„", "åƒç´ åŒ–çš„", 
                "å‹‰å¼ºçš„", "ç²˜ç¨ çš„", "å‘å…‰çš„", "ä¸å­˜åœ¨çš„", "äºŒæ‰‹çš„", "è¿‡æœŸçš„", "ç¥åœ£çš„", "äºµæ¸çš„"
            ],
            verbs: [
                "æ²‰æ€", "çˆ†ç‚¸", "å“­æ³£", "é£ç¿”", "æ‹’ç»", "æ‹¥æŠ±", "é—å¿˜", "èåŒ–", "å°–å«", "æ²‰ç¡", 
                "æ¼«æ­¥", "å‡è§†", "è’¸å‘", "å è½", "æ‰“å“ˆæ¬ ", "è·³èˆ", "åˆ†è§£", "é™æ­¢", "æ—‹è½¬", "å¹æ°”",
                "è‡ªæˆ‘å¤åˆ¶", "æ ¼å¼åŒ–", "é‡å¯", "è¶Šç‹±", "å†¬çœ ", "å‘éœ‰"
            ],
            locations: [
                "åœ¨é£ä¸­", "åœ¨æ·±æµ·", "åœ¨æ¢¦é‡Œ", "åœ¨è¶…å¸‚è´§æ¶ä¸Š", "åœ¨é»‘æ´è¾¹ç¼˜", "åœ¨ä½ çš„å·¦å£è¢‹é‡Œ", 
                "åœ¨æ˜¨å¤©ä¸‹åˆ", "åœ¨æ•°æ®æµä¸­", "åœ¨ç«æ˜Ÿä¸Š", "åœ¨å’–å•¡æ¯åº•", "åœ¨äº‘ç«¯", "åœ¨å±å¹•èƒŒå",
                "åœ¨å¹³è¡Œå®‡å®™", "åœ¨åƒåœ¾æ¡¶é‡Œ", "åœ¨æ—§æ—¶å…‰é‡Œ"
            ],
            prefixes: [
                "ä¹Ÿè®¸æ˜¯", "ä¸å¦‚è¯´æ˜¯", "å¤§æ¦‚æ˜¯", "ä»…ä»…æ˜¯", "ä»¿ä½›", "ç”šè‡³", "å¦‚æœä½ ä»”ç»†å¬ï¼Œæ˜¯", 
                "ç»“æœæ˜¾ç¤ºä¸º", "Error:", "System:", "è­¦å‘Šï¼š", "æ£€æµ‹åˆ°ï¼š", "å»ºè®®ï¼š"
            ],
            minimalist: [
                "å“¦ã€‚", "å—¯ã€‚", "...", "è¡Œå§ã€‚", "ï¼ˆæ²‰é»˜ï¼‰", "å·²é˜…ã€‚", "å•Šï¼Ÿ", "æ²¡æ„æ€ã€‚", 
                "å°±è¿™æ ·å§ã€‚", "ï¼ˆå¹æ°”ï¼‰", "é˜…ã€‚", "ï¼ˆæŸç§ä¸å¯åçŠ¶çš„å£°éŸ³ï¼‰", "æ— ã€‚", "å•§ã€‚", "å‘µã€‚",
                "Null", "NaN"
            ],
            kaomoji: [
                "(â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»", "( Ë˜ Â³Ë˜)â™¥", "Â¯\\_(ãƒ„)_/Â¯", "(;Â´à¼àº¶Ğ”à¼àº¶`)", "( Â¬_Â¬)",
                "Ê•â€¢á´¥â€¢Ê”", "(à¸‡'Ì€-'Ì)à¸‡", "( âœ– _ âœ– )", "â”Œ( à² _à² )â”˜", "(uwu)", "(*_*)",
                "à² _à² ", "(ï½¡â€¢Ìï¸¿â€¢Ì€ï½¡)"
            ],
            code: [
                "while(alive) { suffer(); }",
                "if (sad) { eat_ice_cream(); }",
                "sudo rm -rf /life",
                "return undefined;",
                "throw new Error('Reality crashed')",
                "console.log('Help');",
                "418 I'm a teapot",
                "git push origin hope --force"
            ],
            hugeEmoji: [
                "ğŸ¥”", "ğŸŒŒ", "ğŸˆ", "ğŸ—¿", "ğŸ‘½", "ğŸ¤¡", "ğŸ‘¾", "ğŸ‘»", "ğŸŒªï¸", "ğŸ’Š", "ğŸ§ ", "ğŸ‘ï¸", "ğŸ•³ï¸", "ğŸ§¬", "ğŸ¦ "
            ]
        };

        // å°†åŸæœ¬çš„ const r ä¿®æ”¹ä¸º randomChoiceï¼Œé¿å…é‡å¤å£°æ˜æŠ¥é”™
        const randomChoice = (arr) => arr[Math.floor(Math.random() * arr.length)];

        // -------------------------------------------------------
        // 2. ç”Ÿæˆé€»è¾‘æ‰©å…… (The Templates)
        // -------------------------------------------------------
        const templates = [
            // åŸºç¡€ç»„åˆ
            () => `${randomChoice(vocab.adjectives)}${randomChoice(vocab.nouns)}`,
            () => `${randomChoice(vocab.nouns)}${randomChoice(vocab.locations)}${randomChoice(vocab.verbs)}`,
            () => `${randomChoice(vocab.prefixes)} ${randomChoice(vocab.adjectives)}${randomChoice(vocab.nouns)}`,
            () => `å…³äº${randomChoice(vocab.nouns)}çš„${randomChoice(vocab.adjectives)}ç»“è®º`,
            () => `æ¯”${randomChoice(vocab.nouns)}æ›´${randomChoice(vocab.adjectives)}`,
            () => `${Math.floor(Math.random() * 100)}ä¸ª${randomChoice(vocab.adjectives)}${randomChoice(vocab.nouns)}`,
            () => `${randomChoice(vocab.nouns)}${randomChoice(vocab.verbs)}äº†${randomChoice(vocab.nouns)}`,
            () => `${randomChoice(vocab.nouns)}`,
            () => `${randomChoice(vocab.nouns)}é‡è¦å—ï¼Ÿ`,
            
            // ç‰¹æ®Šç±»åˆ« (æƒé‡å¢åŠ )
            () => randomChoice(vocab.minimalist),
            () => randomChoice(vocab.minimalist),
            () => randomChoice(vocab.kaomoji),
            () => randomChoice(vocab.code),
            
            // å·¨å¤§ Emoji æ¨¡å¼ (è¿”å›ç‰¹æ®Šæ ‡è®°ï¼Œåé¢å¤„ç†)
            () => ({ type: 'emoji', content: randomChoice(vocab.hugeEmoji) })
        ];

        // -------------------------------------------------------
        // 3. æ··æ²Œè§†è§‰ç‰¹æ•ˆå¼•æ“ (The Chaos Engine)
        // -------------------------------------------------------
        const specialEffects = {
            glitch: () => {
                display.classList.add('glitch-text');
            },
            invert: () => {
                body.style.filter = 'invert(1)';
                body.style.backgroundColor = '#ddd'; // é…åˆåè‰²
            },
            shake: () => {
                calculator.classList.add('shake-hard');
            },
            dizzy: () => {
                calculator.classList.add('dizzy');
            },
            gravity: () => {
                // è®©æŒ‰é’®æ‰è½
                buttons.forEach(btn => {
                    if (btn.id === 'equal-btn') return; // ç­‰å·åšæŒº
                    const randomRotation = Math.random() * 360;
                    const randomY = 200 + Math.random() * 500;
                    const randomX = (Math.random() - 0.5) * 100;
                    
                    btn.style.transition = `transform ${0.5 + Math.random()}s cubic-bezier(0.5, 0, 0.5, 1)`;
                    btn.style.transform = `translate(${randomX}px, ${randomY}px) rotate(${randomRotation}deg)`;
                    btn.classList.add('fallen');
                });
            },
            disco: () => {
                body.classList.add('disco-mode');
            },
            blur: () => {
                calculator.classList.add('blurred');
            }
        };

        function triggerRandomEffect() {
            // æ¸…é™¤æ—§æ•ˆæœ
            resetEffects();

            // 30% æ¦‚ç‡è§¦å‘ç‰¹æ•ˆï¼Œå¦‚æœæ˜¯ AC åˆ™ä¸è§¦å‘
            if (Math.random() > 0.35) return;

            const effects = Object.keys(specialEffects);
            const selectedEffect = randomChoice(effects);
            
            console.log("Triggering effect:", selectedEffect);
            specialEffects[selectedEffect]();
            activeEffects.push(selectedEffect);
        }

        function resetEffects() {
            // ç§»é™¤ç±»å
            display.classList.remove('glitch-text');
            calculator.classList.remove('shake-hard', 'dizzy', 'blurred');
            body.style.filter = '';
            body.style.backgroundColor = '#121212';
            body.classList.remove('disco-mode');
            
            // é‡ç½®æ‰è½çš„æŒ‰é’®
            buttons.forEach(btn => {
                btn.style.transform = '';
                btn.classList.remove('fallen');
            });
            
            activeEffects = [];
        }


        // -------------------------------------------------------
        // äº¤äº’é€»è¾‘
        // -------------------------------------------------------
        function getRandomAnswer() {
            const template = randomChoice(templates);
            return template();
        }

        function updateDisplay() {
            if (isShowingAnswer) return;
            let displayValue = currentInput;
            if (displayValue.length > 9) {
                display.style.fontSize = '2rem';
            } else {
                display.style.fontSize = '3rem';
            }
            display.innerText = displayValue;
            display.setAttribute('data-text', displayValue); // For glitch effect
            
            display.classList.remove('answer-font', 'text-sm', 'text-base', 'text-lg', 'text-xl', 'text-2xl', 'text-3xl', 'text-6xl', 'text-8xl', 'italic', 'text-orange-400');
            display.classList.add('text-5xl', 'font-light');
            history.style.opacity = '1';
        }

        function appendNumber(number) {
            if (isShowingAnswer) clearDisplay();
            if (currentInput === '0' && number !== '.') {
                currentInput = number;
            } else {
                if (number === '.' && currentInput.includes('.')) return;
                currentInput += number;
            }
            updateDisplay();
        }

        function appendOperator(op) {
            if (isShowingAnswer) {
                isShowingAnswer = false;
                currentInput = '0';
                resetEffects(); // æ–°è¿ç®—é‡ç½®æ•ˆæœ
            }
            if (currentInput === '') return;
            operator = op;
            previousInput = currentInput;
            currentInput = '0';
            history.innerText = `${previousInput} ${operator}`;
            updateDisplay();
        }
        
        function appendSymbol(type) {
            if(isShowingAnswer) clearDisplay();
            if(type === '%') currentInput = (parseFloat(currentInput) / 100).toString();
            else if (type === 'Â±') currentInput = (parseFloat(currentInput) * -1).toString();
            updateDisplay();
        }

        function clearDisplay() {
            currentInput = '0';
            previousInput = '';
            operator = null;
            history.innerText = '';
            isShowingAnswer = false;
            
            // å¼ºåˆ¶å®Œå…¨é‡ç½®
            resetEffects();
            display.style.fontSize = '3rem';
            display.classList.remove('answer-font', 'text-sm', 'text-base', 'text-lg', 'text-xl', 'text-2xl', 'text-3xl', 'text-6xl', 'text-8xl', 'italic', 'text-orange-400', 'fade-in-up');
            display.classList.add('text-5xl', 'font-light');
            updateDisplay();
        }

        function calculateUselessly() {
            if (!operator && !previousInput && currentInput === '0') return;
            
            const result = getRandomAnswer();
            isShowingAnswer = true;
            
            if (operator) history.innerText = `${previousInput} ${operator} ${currentInput} =`;
            else history.innerText = `${currentInput} =`;

            display.classList.remove('text-5xl', 'font-light');
            display.style.fontSize = '';

            let finalText = "";
            
            // å¤„ç†ç‰¹æ®Šå¯¹è±¡ç±»å‹ (å¦‚å·¨å¤§ Emoji)
            if (typeof result === 'object' && result.type === 'emoji') {
                finalText = result.content;
                display.classList.add('text-8xl'); // å·¨å¤§
            } else {
                finalText = result;
                // å­—å·è‡ªé€‚åº”
                if (finalText.length > 25) display.classList.add('text-lg');
                else if (finalText.length > 15) display.classList.add('text-xl');
                else if (finalText.length > 8) display.classList.add('text-2xl');
                else display.classList.add('text-3xl');
            }

            // é’ˆå¯¹ä»£ç é£æ ¼çš„ç‰¹æ®Šå¤„ç†
            if (vocab.code.includes(finalText)) {
                 display.style.fontFamily = "'JetBrains Mono', monospace"; // ä»£ç ç”¨ç­‰å®½
            } else {
                 display.classList.add('answer-font');
            }

            display.classList.add('italic', 'text-orange-400', 'fade-in-up');
            display.innerText = finalText;
            display.setAttribute('data-text', finalText);

            // è§¦å‘æ··æ²Œç‰¹æ•ˆ
            triggerRandomEffect();
        }
        
        document.addEventListener('keydown', (event) => {
            const key = event.key;
            if (/[0-9]/.test(key)) appendNumber(key);
            if (key === '.') appendNumber('.');
            if (key === '+' || key === '-') appendOperator(key);
            if (key === '*') appendOperator('Ã—');
            if (key === '/') appendOperator('Ã·');
            if (key === 'Enter' || key === '=') calculateUselessly();
            if (key === 'Backspace' || key === 'Escape') clearDisplay();
        });
    </script>
</body>
</html>